<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>cabilapp documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">cabilapp documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content injectable">
                   <div class="content-data">








<ol class="breadcrumb">
  <li>Injectables</li>
  <li >DbService</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/app/services/db.service.ts</code>
        </p>


            <p class="comment">
                <h3>Description</h3>
            </p>
            <p class="comment">
                <p>Servicio que manipula SQLite y hace llamados a la API</p>

            </p>



            <section>
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>
                <tr>
                    <td class="col-md-4">
                        <h6><b>Properties</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#_sqlInstance" >_sqlInstance</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#answeredSurvey" >answeredSurvey</a>
                            </li>
                        </ul>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                <a href="#cleanLocalDb" >cleanLocalDb</a>
                            </li>
                            <li>
                                <a href="#deleteSql" >deleteSql</a>
                            </li>
                            <li>
                                <a href="#deleteSurveysSql" >deleteSurveysSql</a>
                            </li>
                            <li>
                                <a href="#dismissLoading" >dismissLoading</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#getAllAnsweredSurveys" >getAllAnsweredSurveys</a>
                            </li>
                            <li>
                                <a href="#initSql" >initSql</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#presentLoading" >presentLoading</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#saveSurveyToLocalDB" >saveSurveyToLocalDB</a>
                            </li>
                            <li>
                                <a href="#saveSurveyToSql" >saveSurveyToSql</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#selectSql" >selectSql</a>
                            </li>
                            <li>
                                <a href="#syncSurvey" >syncSurvey</a>
                            </li>
                        </ul>
                    </td>
                </tr>





                    <tr>
                        <td class="col-md-4">
                            <h6><b>Accessors</b></h6>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <ul class="index-list">
                                <li>
                                    <a href="#sqlInstance" >sqlInstance</a>
                                </li>
                            </ul>
                        </td>
                    </tr>
        </tbody>
    </table>
</section>


            <section>
    
    <h3 id="methods">
        Methods
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="cleanLocalDb"></a>
                    <span class="name">
                        <span ><b>cleanLocalDb</b></span>
                        <a href="#cleanLocalDb"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>cleanLocalDb()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="69"
                            class="link-to-prism">src/app/services/db.service.ts:69</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Funcion para limpiar base de datos SQLlite, luego redirecciona al HOME</p>
</div>

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="deleteSql"></a>
                    <span class="name">
                        <span ><b>deleteSql</b></span>
                        <a href="#deleteSql"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>deleteSql(table?: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="206"
                            class="link-to-prism">src/app/services/db.service.ts:206</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Funcion para realizar sentencia DELETE en SQLite de una tabla</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>table</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        Yes
                                    </td>


                                    <td>
                                        <p>Nombre de la tabla a seleccionar</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="deleteSurveysSql"></a>
                    <span class="name">
                        <span ><b>deleteSurveysSql</b></span>
                        <a href="#deleteSurveysSql"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>deleteSurveysSql()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="223"
                            class="link-to-prism">src/app/services/db.service.ts:223</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Funcion para realizar sentencia DELETE en SQLite de una tabla</p>
</div>

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="dismissLoading"></a>
                    <span class="name">
                        <span ><b>dismissLoading</b></span>
                        <a href="#dismissLoading"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>dismissLoading()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="97"
                            class="link-to-prism">src/app/services/db.service.ts:97</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Funcion para cerrar animacion de cargando</p>
</div>

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getAllAnsweredSurveys"></a>
                    <span class="name">
                        <span class="modifier">Async</span>
                        <span ><b>getAllAnsweredSurveys</b></span>
                        <a href="#getAllAnsweredSurveys"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getAllAnsweredSurveys()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="292"
                            class="link-to-prism">src/app/services/db.service.ts:292</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Funcion que hace llamado a una seentencia SQL para obtener todas las encuestas respondidas</p>
</div>

                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>unknown</code>

                    </div>
                    <div class="io-description">
                        <p>retorna lista de encuestas respondidas</p>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="initSql"></a>
                    <span class="name">
                        <span ><b>initSql</b></span>
                        <a href="#initSql"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>initSql()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="120"
                            class="link-to-prism">src/app/services/db.service.ts:120</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Funcion que crea las tablas de SQLite localmente: mainForm y surveys</p>
</div>

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="presentLoading"></a>
                    <span class="name">
                        <span class="modifier">Async</span>
                        <span ><b>presentLoading</b></span>
                        <a href="#presentLoading"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>presentLoading()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="85"
                            class="link-to-prism">src/app/services/db.service.ts:85</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Funcion que presenta una anuimacion de cargando durante 1 segundo</p>
</div>

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="saveSurveyToLocalDB"></a>
                    <span class="name">
                        <span class="modifier">Async</span>
                        <span ><b>saveSurveyToLocalDB</b></span>
                        <a href="#saveSurveyToLocalDB"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>saveSurveyToLocalDB(surveyAnswered, _surveyName, _surveyId, _date)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="307"
                            class="link-to-prism">src/app/services/db.service.ts:307</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Funcion para mapear y posteriormente guardar una encuesta en SQLite, que se respondio previamente.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>surveyAnswered</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>_surveyName</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>_surveyId</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>_date</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>unknown</code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="saveSurveyToSql"></a>
                    <span class="name">
                        <span ><b>saveSurveyToSql</b></span>
                        <a href="#saveSurveyToSql"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>saveSurveyToSql(surveyAnswered: <a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank">any</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="241"
                            class="link-to-prism">src/app/services/db.service.ts:241</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Funcion que toma las respuestas de una encuesta, agruega un campo unica para cada respuesta
luego se ejecuta una sentencia SQL INSERT, para guardar la respuesta de forma local en SQLite</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>surveyAnswered</td>
                                    <td>
                                                <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>Objecto con la encuesta respondida y tipada para guardar</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                    <div class="io-description">
                        <p>retorna respuesta de Sentencia SQL</p>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="selectSql"></a>
                    <span class="name">
                        <span class="modifier">Async</span>
                        <span ><b>selectSql</b></span>
                        <a href="#selectSql"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>selectSql(table: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="194"
                            class="link-to-prism">src/app/services/db.service.ts:194</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Funcion para realizar sentencia SELECT en SQLite de una tabla</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>table</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>Nombre de la tabla a seleccionar</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>Promise&lt;any&gt;</code>

                    </div>
                    <div class="io-description">
                        <p>retorna la respuesta de la sentencia SQL</p>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="syncSurvey"></a>
                    <span class="name">
                        <span ><b>syncSurvey</b></span>
                        <a href="#syncSurvey"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>syncSurvey(surveys: AnswerSurvey[])</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="50"
                            class="link-to-prism">src/app/services/db.service.ts:50</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Funcion que hace llamada a la API para guardar las
respuestas en la nube, luego limpia la BD SQLlite</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>surveys</td>
                                    <td>
                                            <code>AnswerSurvey[]</code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>Lista de respuestas de encuesta</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</section>
            <section>
    
    <h3 id="inputs">
        Properties
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="_sqlInstance"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                        <span ><b>_sqlInstance</b></span>
                        <a href="#_sqlInstance"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>    <code>SQLiteObject</code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="24" class="link-to-prism">src/app/services/db.service.ts:24</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Objeto de instancia para SQLite</p>
</div>
                </td>
            </tr>

        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="answeredSurvey"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                        <span ><b>answeredSurvey</b></span>
                        <a href="#answeredSurvey"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>{} as AnswerSurvey</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="29" class="link-to-prism">src/app/services/db.service.ts:29</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Objeto para guardar temporalmente las respuestas de las encuestas</p>
</div>
                </td>
            </tr>

        </tbody>
    </table>
</section>

            <section>
    <h3 id="accessors">
        Accessors
    </h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="sqlInstance"></a>
                        <span class="name"><b>sqlInstance</b><a href="#sqlInstance"><span class="icon ion-ios-link"></span></a></span>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <span class="accessor"><b>get</b><code>sqlInstance()</code></span>
                    </td>
                </tr>
                            <tr>
                                <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="112" class="link-to-prism">src/app/services/db.service.ts:112</a></div>
                                </td>
                            </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Funcion GETTER obtener instancia de SQLite</p>
</div>

                                <div class="io-description">
                                    <b>Returns : </b>    <code>SQLiteObject</code>

                                </div>
                        </td>
                    </tr>

                <tr>
                    <td class="col-md-4">
                        <span class="accessor"><b>set</b><code>sqlInstance(v: SQLiteObject)</code></span>
                    </td>
                </tr>
                            <tr>
                                <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="104" class="link-to-prism">src/app/services/db.service.ts:104</a></div>
                                </td>
                            </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Funcion SETTER para asignar instancia de SQLlite</p>
</div>

                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <table class="params">
                                            <thead>
                                                <tr>
                                                    <td>Name</td>
                                                        <td>Type</td>
                                                    <td>Optional</td>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                    <tr>
                                                            <td>v</td>
                                                    
                                                            <td>
                                                                        <code>SQLiteObject</code>
                                                            </td>
                                                    
                                                        <td>
                                                                No
                                                        </td>
                                                        
                                                    </tr>
                                            </tbody>
                                        </table>
                                </div>
                                <div>
                                </div>
                                <div class="io-description">
                                    <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                                </div>
                        </td>
                    </tr>
            </tbody>
        </table>
</section>
    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Injectable } from &#x27;@angular/core&#x27;;
  import { HttpClient } from &#x27;@angular/common/http&#x27;;
import { AnswerSurvey } from &#x27;../interfaces/answer-survey&#x27;;
import { SurveyService } from &#x27;./survey.service&#x27;;
import { Router } from &#x27;@angular/router&#x27;;
import { SubjectsService } from &#x27;./subjects.service&#x27;;
import { LoadingController } from &#x27;@ionic/angular&#x27;;
import { SQLite, SQLiteObject } from &#x27;@awesome-cordova-plugins/sqlite/ngx&#x27;;
import { mainForm } from &#x27;../interfaces/mainForm&#x27;;

/**
 * Servicio que manipula SQLite y hace llamados a la API
 */

@Injectable({
  providedIn: &#x27;root&#x27;
})
export class DbService {

  /**
   * Objeto de instancia para SQLite
   */
  private _sqlInstance: SQLiteObject;

  /**
   * Objeto para guardar temporalmente las respuestas de las encuestas
   */
  private answeredSurvey &#x3D; {} as AnswerSurvey;

    /**
     * @ignore
     */
    constructor(
      private httpClient: HttpClient, 
      private router: Router,
      private subjectService: SubjectsService,
      private loadingController: LoadingController,
      private sqlite: SQLite,
      private surveyservice: SurveyService
       ) { }
    
  

    /**
     * Funcion que hace llamada a la API para guardar las 
     * respuestas en la nube, luego limpia la BD SQLlite
     * @param {Array&lt;AnswerSurvey&gt;} surveys Lista de respuestas de encuesta
     */   
    syncSurvey(surveys: AnswerSurvey[]){
      this.presentLoading();

      // https://cabilapp.herokuapp.com

      this.httpClient.post&lt;any&gt;(&#x27;https://cabilapp.herokuapp.com/sync&#x27;,surveys).subscribe(data &#x3D;&gt; {
        this.cleanLocalDb();

      }, err &#x3D;&gt; {
        this.loadingController.dismiss();
         this.surveyservice.presentToast(&#x27;Error Sync&#x27;)

      });
    }


    /**
     * Funcion para limpiar base de datos SQLlite, luego redirecciona al HOME
     */
    cleanLocalDb(){
     
      localStorage.clear();
      this.deleteSurveysSql();
      this.surveyservice.presentToast(&#x27;Resuestas sincronizadas.&#x27;);
      this.router.navigateByUrl(&#x27;home&#x27;);
      this.subjectService.setSubject(&#x27;homeSurveysCount&#x27;,true);
      setTimeout(() &#x3D;&gt; {
        this.loadingController.dismiss();
      }, 1000);

    }

   /**
 * Funcion que presenta una anuimacion de cargando durante 1 segundo
  */
    async presentLoading() {
      const loading &#x3D; await this.loadingController.create({
        message: &#x27;Sincronizando&#x27;,
        spinner: &#x27;bubbles&#x27;
      });
      await loading.present();
    }


    /**
     * Funcion para cerrar animacion de cargando
     */
    dismissLoading(){
      this.loadingController.dismiss();
    }

    /**
     * Funcion SETTER para asignar instancia de SQLlite
     */
    public set sqlInstance(v : SQLiteObject) {
      this._sqlInstance &#x3D; v;
    }
  
    
    /**
     * Funcion GETTER obtener instancia de SQLite
     */
    public get sqlInstance() : SQLiteObject {
      return this._sqlInstance
    }


    /**
     * Funcion que crea las tablas de SQLite localmente: mainForm y surveys
     */
    initSql(){     

    this.sqlite.create({
      name: &#x27;data.db&#x27;,
      location: &#x27;default&#x27;
    })
      .then((db: SQLiteObject) &#x3D;&gt; {

        console.log(&#x27;sqlite Instance:&#x27;, db );
        
        this.sqlInstance &#x3D; db;
        
        //  this.deleteSql();

        db.executeSql(
          &#x60;CREATE TABLE  mainForm (
            NumeroIdentificacion  INTEGER,
            sexo  INTEGER,
            IntervaloEdad  INTEGER,
            Genero  INTEGER,
            GrupEtnico  INTEGER,
            id_MarquesasApp_Municipio_id  INTEGER,
            Zona TEXT,
            condicion_discapacidad TEXT ,
            conflicto_armado  TEXT,
            img  TEXT
            )&#x60;, [])
          .then(() &#x3D;&gt; {console.log(&#x27;Executed MAINFORM SQL&#x27;); })
          .catch(e &#x3D;&gt; console.log(&#x27;Error&#x27;, e));

          db.executeSql(
            
            &#x60;CREATE TABLE  surveys (
              NumeroIdentificacion INTEGER, 
              IntervaloEdad INTEGER,
              Genero INTEGER,
              GrupEtnico INTEGER,
              Zona INTEGER,
              Respuesta1 INTEGER,
              Respuesta2 INTEGER,
              Respuesta3 INTEGER,
              Respuesta4 INTEGER,
              Respuesta5 INTEGER,
              Respuesta6 INTEGER,
              Respuesta7 INTEGER,
              Respuesta8 INTEGER,
              Respuesta9 INTEGER,
              Respuesta10 INTEGER,
              Respuesta11 INTEGER,
              Respuesta12 INTEGER,
              date_created TEXT,
              usuario TEXT,
              id_MarquesasApp_Municipio_id INTEGER,
              id_WebTablasBasicasApp_encuesta_id INTEGER,
              sexo INTEGER, 
              condicion_discapacidad TEXT,
              conflicto_armado TEXT,
              surveyName TEXT,
              img TEXT,
              idRespuesta TEXT
              )&#x60;, [])
            .then(() &#x3D;&gt; {console.log(&#x27;Executed SURVEY SQL&#x27;); })
            .catch(e &#x3D;&gt; console.log(&#x27;Error&#x27;, e));
    
    
      })
      .catch(e &#x3D;&gt; console.log(e));
    }

    /**
     * Funcion para realizar sentencia SELECT en SQLite de una tabla
     * @param {string} table  Nombre de la tabla a seleccionar
     * @returns retorna la respuesta de la sentencia SQL
     */
    async selectSql(table: string):Promise&lt;any&gt;{

      var testsql :SQLiteObject &#x3D; this.sqlInstance;
     return  testsql.executeSql(&#x60;SELECT * FROM ${table} &#x60;,[])
     
    }


    /**
     * Funcion para realizar sentencia DELETE en SQLite de una tabla
     *@param {string} table  Nombre de la tabla a seleccionar
     */
    deleteSql(table?:string){

      var testsql :SQLiteObject &#x3D; this.sqlInstance;
      testsql.executeSql(&#x27;DELETE FROM mainForm &#x27;,[])
      .then(res &#x3D;&gt; {

        console.log(&#x27;Table deleted&#x27;)
      }).catch(err &#x3D;&gt; {

        console.error(err)
      })
    }

      /**
     * Funcion para realizar sentencia DELETE en SQLite de una tabla
     *@param {string} table  Nombre de la tabla a seleccionar
     */
    deleteSurveysSql(){
      var testsql :SQLiteObject &#x3D; this.sqlInstance;
      testsql.executeSql(&#x27;DELETE FROM surveys &#x27;,[])
      .then(res &#x3D;&gt; {

        console.log(&#x27;Table surveys deleted&#x27;)
      }).catch(err &#x3D;&gt; {

        console.error(err)
      })
    }

    /**
     * Funcion que toma las respuestas de una encuesta, agruega un campo unica para cada respuesta
     * luego se ejecuta una sentencia SQL INSERT, para guardar la respuesta de forma local en SQLite
     * @param surveyAnswered Objecto con la encuesta respondida y tipada para guardar
     * @returns retorna respuesta de Sentencia SQL
     */
    saveSurveyToSql(surveyAnswered: any){


      var subS &#x3D; (surveyAnswered.NumeroIdentificacion + &quot; &quot;).substring(0,3)

      var idRespuesta &#x3D; &#x60;${subS}${surveyAnswered.id_MarquesasApp_Municipio_id}${surveyAnswered.img.substring(2500,2503)}&#x60;

      var sql: SQLiteObject &#x3D; this.sqlInstance;

 

      return sql.executeSql(&#x60;
      INSERT INTO surveys 
      VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)&#x60;,
      [
        surveyAnswered.NumeroIdentificacion, 
        surveyAnswered.IntervaloEdad,
        surveyAnswered.Genero,
        surveyAnswered.GrupEtnico,
        surveyAnswered.Zona,
        surveyAnswered.Respuesta1,
        surveyAnswered.Respuesta2,
        surveyAnswered.Respuesta3,
        surveyAnswered.Respuesta4,
        surveyAnswered.Respuesta5,
        surveyAnswered.Respuesta6,
        surveyAnswered.Respuesta7,
        surveyAnswered.Respuesta8,
        surveyAnswered.Respuesta9,
        surveyAnswered.Respuesta10,
        surveyAnswered.Respuesta11,
        surveyAnswered.Respuesta12,
        surveyAnswered.date_created,
        surveyAnswered.usuario,
        surveyAnswered.id_MarquesasApp_Municipio_id,
        surveyAnswered.id_WebTablasBasicasApp_encuesta_id,
        surveyAnswered.sexo, 
        surveyAnswered.condicion_discapacidad,
        surveyAnswered.conflicto_armado,
        surveyAnswered.surveyName,
        surveyAnswered.img,
        idRespuesta
      ]); 

    }


    /**
     * Funcion que hace llamado a una seentencia SQL para obtener todas las encuestas respondidas
     * @returns retorna lista de encuestas respondidas
     */
   async getAllAnsweredSurveys(){

    let surveys &#x3D; await this.selectSql(&#x27;surveys&#x27;);   

      return  surveys.rows;
    };

    /**
     * Funcion para mapear y posteriormente guardar una encuesta en SQLite, que se respondio previamente.
     * @param surveyAnswered 
     * @param {string} _surveyName 
     * @param {any} _surveyId 
     * @param {Date} _date 
     * @returns 
     */
   async saveSurveyToLocalDB(surveyAnswered , _surveyName, _surveyId, _date){     
     
  
       let mainForm &#x3D; await this.selectSql(&#x27;mainForm&#x27;);

  
      this.answeredSurvey &#x3D; {
        ...mainForm.rows.item(0),
        Respuesta1: surveyAnswered[0],
        Respuesta2: surveyAnswered[1],
        Respuesta3: surveyAnswered[2],
        Respuesta4: surveyAnswered[3],
        Respuesta5: surveyAnswered[4],
        Respuesta6: surveyAnswered[5],
        Respuesta7: surveyAnswered[6],
        Respuesta8: surveyAnswered[7],
        Respuesta9: surveyAnswered[8],
        Respuesta10: surveyAnswered[9],
        Respuesta11: surveyAnswered[10],
        Respuesta12: surveyAnswered[11],
        date_created: _date,
        usuario: &#x27;marquesa&#x27;,
        id_WebTablasBasicasApp_encuesta_id: _surveyId,
        surveyName: _surveyName
      }
      
       let saveSurveyStatus &#x3D; await this.saveSurveyToSql(this.answeredSurvey);   
       this.deleteSql();
       
       return saveSurveyStatus;
      
    }
}

</code></pre>
    </div>

</div>













                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

          <label class="dark-mode-switch">
               <input type="checkbox">
               <span class="slider">
                    <svg class="slider-icon" viewBox="0 0 24 24" fill="none" height="20" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
               </span>
          </label>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'injectable';
            var COMPODOC_CURRENT_PAGE_URL = 'DbService.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
