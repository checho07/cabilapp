<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>cabilapp documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	    <link rel="stylesheet" href="../styles/style.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">cabilapp documentation</a>
            <button type="button" class="btn btn-default btn-menu fa fa-bars" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
            <div id="book-search-input" role="search">
                <input type="text" placeholder="Type to search">
            </div>
            <nav>
            
                <ul class="list">
            
                    <li class="title">
                        <a href="../">cabilapp documentation</a>
                    </li>
            
                    <li class="divider"></li>
            
            
                    <li class="chapter">
                        <a data-type="chapter-link" href="../"><span class="fa fa-home"></span>Getting started</a>
                        <ul class="links">
                                <li class="link">
                                    <a href="../" ><span class="fa fa-file-text-o"></span>README</a>
                                </li>
                                <li class="link">
                                    <a 
                                        
                                         href="../overview.html" 
                                         href="../overview.html" 
                                        >
                                        <span class="fa fa-th"></span>Overview
                                    </a>
                                </li>
                        </ul>
                    </li>
            
                    <li class="chapter">
                        <a data-type="chapter-link" href="./modules.html" >
                            <span class="fa fa-archive"></span>
                            <span>Modules</span>
                            <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                    data-target="#xs-modules-links"
                            ></span>
                        </a>
                        <ul class="links collapse in"
                                id="xs-modules-links"
                            >
                                <li class="link">
                                    <a href="../modules/AppModule.html" >AppModule</a>
                                </li>
                                <li class="link">
                                    <a href="../modules/HomePageModule.html" >HomePageModule</a>
                                </li>
                                <li class="link">
                                    <a href="../modules/SurveyPageModule.html" >SurveyPageModule</a>
                                </li>
                                <li class="link">
                                    <a href="../modules/SurveyPageRoutingModule.html" >SurveyPageRoutingModule</a>
                                </li>
                        </ul>
                    </li>
            
                    <li class="chapter">
                        <div class="simple">
                            <span class="fa fa-cogs"></span>
                            <span>Components</span>
                            <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                    data-target="#xs-components-links"
                                ></span>
                        </div>
                        <ul class="links collapse in"
                                id="xs-components-links"
                            >
                                <li class="link">
                                    <a href="../components/AppComponent.html" >AppComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/HomePage.html" >HomePage</a>
                                </li>
                                <li class="link">
                                    <a href="../components/MainformComponent.html" >MainformComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/SurveyComponent.html" >SurveyComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/SurveyListComponent.html" >SurveyListComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/SurveyPage.html" >SurveyPage</a>
                                </li>
                        </ul>
                    </li>
            
                    <li class="chapter">
                        <div class="simple">
                            <span class="fa fa-code"></span>
                            <span>Directives</span>
                            <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                    data-target="#xs-directives-links"
                                ></span>
                        </div>
                        <ul class="links collapse in"
                                id="xs-directives-links"
                            >
                                <li class="link">
                                    <a href="../directives/OnlynumbersDirective.html" >OnlynumbersDirective</a>
                                </li>
                        </ul>
                    </li>
            
                    <li class="chapter">
                        <div class="simple">
                            <span class="fa fa-file-code-o"></span>
                            <span>Classes</span>
                            <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                    data-target="#xs-classes-links"
                                ></span>
                        </div>
                        <ul class="links collapse in"
                                id="xs-classes-links"
                            >
                                <li class="link">
                                    <a href="../classes/AppPage.html" >AppPage</a>
                                </li>
                        </ul>
                    </li>
            
                    <li class="chapter">
                        <a data-type="chapter-link" href="../routes.html" ><span class="fa fa-code-fork"></span>Routes</a>
                    </li>
            
                    <li class="chapter">
                        <div class="simple">
                            <span class="fa fa-long-arrow-down"></span>
                            <span>Injectables</span>
                            <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                    data-target="#xs-injectables-links"
                                ></span>
                        </div>
                        <ul class="links collapse in"
                                id="xs-injectables-links"
                            >
                                <li class="link">
                                    <a href="../injectables/DbService.html"  class="active" >DbService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/SubjectsService.html" >SubjectsService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/SurveyService.html" >SurveyService</a>
                                </li>
                        </ul>
                    </li>
            
                    <li class="chapter">
                        <div class="simple">
                            <span class="fa fa-info"></span>
                            <span>Interfaces</span>
                            <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                    data-target="#xs-interfaces-links"
                                ></span>
                        </div>
                        <ul class="links collapse in"
                                id="xs-interfaces-links"
                            >
                                <li class="link">
                                    <a href="../interfaces/AnswerSurvey.html" >AnswerSurvey</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/Survey.html" >Survey</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/mainForm.html" >mainForm</a>
                                </li>
                        </ul>
                    </li>
            
            
                    <li class="chapter">
                        <a data-type="chapter-link" href="../miscellaneous.html" ><span class="fa fa-cubes"></span>Miscellaneous</a>
                    </li>
            
                    <li class="chapter">
                        <a data-type="chapter-link" href="../coverage.html" ><span class="fa fa-tasks"></span>Documentation coverage</a>
                    </li>
            
                    <li class="divider"></li>
                    <li class="copyright">
                            Documentation generated using <a href="https://compodoc.github.io/compodoc/" target="_blank">
                                        <img src="..//images/compodoc-vectorise.svg" class="img-responsive">
                            </a>
                    </li>
            
                </ul>
            
            </nav>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <nav>
                   
                       <ul class="list">
                   
                           <li class="title">
                               <a href="../">cabilapp documentation</a>
                           </li>
                   
                           <li class="divider"></li>
                   
                               <div id="book-search-input" role="search">
                                   <input type="text" placeholder="Type to search">
                               </div>
                   
                           <li class="chapter">
                               <a data-type="chapter-link" href="../"><span class="fa fa-home"></span>Getting started</a>
                               <ul class="links">
                                       <li class="link">
                                           <a href="../" ><span class="fa fa-file-text-o"></span>README</a>
                                       </li>
                                       <li class="link">
                                           <a 
                                               
                                                href="../overview.html" 
                                                href="../overview.html" 
                                               >
                                               <span class="fa fa-th"></span>Overview
                                           </a>
                                       </li>
                               </ul>
                           </li>
                   
                           <li class="chapter">
                               <a data-type="chapter-link" href="./modules.html" >
                                   <span class="fa fa-archive"></span>
                                   <span>Modules</span>
                                   <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                           data-target="#modules-links"
                                   ></span>
                               </a>
                               <ul class="links collapse in"
                                       id="modules-links"
                   >
                                       <li class="link">
                                           <a href="../modules/AppModule.html" >AppModule</a>
                                       </li>
                                       <li class="link">
                                           <a href="../modules/HomePageModule.html" >HomePageModule</a>
                                       </li>
                                       <li class="link">
                                           <a href="../modules/SurveyPageModule.html" >SurveyPageModule</a>
                                       </li>
                                       <li class="link">
                                           <a href="../modules/SurveyPageRoutingModule.html" >SurveyPageRoutingModule</a>
                                       </li>
                               </ul>
                           </li>
                   
                           <li class="chapter">
                               <div class="simple">
                                   <span class="fa fa-cogs"></span>
                                   <span>Components</span>
                                   <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                           data-target="#components-links"
                   ></span>
                               </div>
                               <ul class="links collapse in"
                                       id="components-links"
                   >
                                       <li class="link">
                                           <a href="../components/AppComponent.html" >AppComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/HomePage.html" >HomePage</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/MainformComponent.html" >MainformComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/SurveyComponent.html" >SurveyComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/SurveyListComponent.html" >SurveyListComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/SurveyPage.html" >SurveyPage</a>
                                       </li>
                               </ul>
                           </li>
                   
                           <li class="chapter">
                               <div class="simple">
                                   <span class="fa fa-code"></span>
                                   <span>Directives</span>
                                   <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                           data-target="#directives-links"
                   ></span>
                               </div>
                               <ul class="links collapse in"
                                       id="directives-links"
                   >
                                       <li class="link">
                                           <a href="../directives/OnlynumbersDirective.html" >OnlynumbersDirective</a>
                                       </li>
                               </ul>
                           </li>
                   
                           <li class="chapter">
                               <div class="simple">
                                   <span class="fa fa-file-code-o"></span>
                                   <span>Classes</span>
                                   <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                           data-target="#classes-links"
                   ></span>
                               </div>
                               <ul class="links collapse in"
                                       id="classes-links"
                   >
                                       <li class="link">
                                           <a href="../classes/AppPage.html" >AppPage</a>
                                       </li>
                               </ul>
                           </li>
                   
                           <li class="chapter">
                               <a data-type="chapter-link" href="../routes.html" ><span class="fa fa-code-fork"></span>Routes</a>
                           </li>
                   
                           <li class="chapter">
                               <div class="simple">
                                   <span class="fa fa-long-arrow-down"></span>
                                   <span>Injectables</span>
                                   <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                           data-target="#injectables-links"
                   ></span>
                               </div>
                               <ul class="links collapse in"
                                       id="injectables-links"
                   >
                                       <li class="link">
                                           <a href="../injectables/DbService.html"  class="active" >DbService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/SubjectsService.html" >SubjectsService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/SurveyService.html" >SurveyService</a>
                                       </li>
                               </ul>
                           </li>
                   
                           <li class="chapter">
                               <div class="simple">
                                   <span class="fa fa-info"></span>
                                   <span>Interfaces</span>
                                   <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                           data-target="#interfaces-links"
                   ></span>
                               </div>
                               <ul class="links collapse in"
                                       id="interfaces-links"
                   >
                                       <li class="link">
                                           <a href="../interfaces/AnswerSurvey.html" >AnswerSurvey</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/Survey.html" >Survey</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/mainForm.html" >mainForm</a>
                                       </li>
                               </ul>
                           </li>
                   
                   
                           <li class="chapter">
                               <a data-type="chapter-link" href="../miscellaneous.html" ><span class="fa fa-cubes"></span>Miscellaneous</a>
                           </li>
                   
                           <li class="chapter">
                               <a data-type="chapter-link" href="../coverage.html" ><span class="fa fa-tasks"></span>Documentation coverage</a>
                           </li>
                   
                           <li class="divider"></li>
                           <li class="copyright">
                                   Documentation generated using <a href="https://compodoc.github.io/compodoc/" target="_blank">
                                               <img src="..//images/compodoc-vectorise.svg" class="img-responsive">
                                   </a>
                           </li>
                   
                       </ul>
                   
                   </nav>
               </div>
               <div class="content injectable">
                   <div class="content-data">




<ol class="breadcrumb">
  <li>Injectables</li>
  <li>DbService</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
    <li class="active">
        <a href="#infos" id="infos-tab" role="tab" data-toggle="tab">Infos</a>
    </li>
    <li>
        <a href="#source" role="tab" id="source-tab" data-toggle="tab">Source</a>
    </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="infos">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/app/services/db.service.ts</code>
        </p>

            <p class="comment">
                <h3>Description</h3>
            </p>
            <p class="comment">
                <p>Servicio que manipula SQLite y hace llamados a la API</p>

            </p>

            <section>
                <h3 id="constructor">Constructor</h3>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <code>constructor(httpClient: HttpClient, router: <a href="https://angular.io/docs/ts/latest/api/router/index/Router-class.html" target="_blank" >Router</a>, subjectService: <a href="../injectables/SubjectsService.html" >SubjectsService</a>, loadingController: LoadingController, sqlite: SQLite, surveyservice: <a href="../injectables/SurveyService.html" >SurveyService</a>)</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description">
                                        </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
            </section>

            <section>
                <h3 id="methods">Methods</h3>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> syncSurvey</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
            <code>syncSurvey(surveys: AnswerSurvey[])</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description"><p>Funcion que hace llamada a la API para guardar las<br>respuestas en la nube, luego limpia la BD SQLlite</p>
            </div>
                                        <div class="io-description">
                                                <b>Parameters :</b>
                                                <ul class="jsdoc-params">
                                                        <li>
                                                            <div>
                                                                <b>surveys</b>
                                                                    :     <code>Array</code>
            
                                                            </div>
                                                            <div>
                                                                <p>Lista de respuestas de encuesta</p>
            
                                                            </div>
                                                        </li>
                                                </ul>
                                        </div>
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                            <div class="io-description">
                                                
                                            </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> cleanLocalDb</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
            <code>cleanLocalDb()</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description"><p>Funcion para limpiar base de datos SQLlite, luego redirecciona al HOME</p>
            </div>
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b><span class="modifier"></span> presentLoading</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <span class="modifier-icon method fa fa-play ">
                                            <span class="fa fa-"></span>
                                        </span>
                                    <code>presentLoading()</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description"><p>Funcion que presenta una anuimacion de cargando durante 1 segundo</p>
            </div>
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> dismissLoading</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
            <code>dismissLoading()</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description"><p>Funcion para cerrar animacion de cargando</p>
            </div>
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> initSql</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
            <code>initSql()</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description"><p>Funcion que crea las tablas de SQLite localmente: mainForm y surveys</p>
            </div>
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b><span class="modifier"></span> selectSql</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <span class="modifier-icon method fa fa-play ">
                                            <span class="fa fa-"></span>
                                        </span>
                                    <code>selectSql(table: string)</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description"><p>Funcion para realizar sentencia SELECT en SQLite de una tabla</p>
            </div>
                                        <div class="io-description">
                                                <b>Parameters :</b>
                                                <ul class="jsdoc-params">
                                                        <li>
                                                            <div>
                                                                <b>table</b>
                                                            </div>
                                                            <div>
                                                                <p>Nombre de la tabla a seleccionar</p>
            
                                                            </div>
                                                        </li>
                                                </ul>
                                        </div>
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>any</code>
            
                                        </div>
                                            <div class="io-description">
                                                <p>retorna la respuesta de la sentencia SQL</p>
            
                                            </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> deleteSql</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
            <code>deleteSql(table: string)</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description"><p>Funcion para realizar sentencia DELETE en SQLite de una tabla</p>
            </div>
                                        <div class="io-description">
                                                <b>Parameters :</b>
                                                <ul class="jsdoc-params">
                                                        <li>
                                                            <div>
                                                                <b>table</b>
                                                            </div>
                                                            <div>
                                                                <p>Nombre de la tabla a seleccionar</p>
            
                                                            </div>
                                                        </li>
                                                </ul>
                                        </div>
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                            <div class="io-description">
                                                
                                            </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> deleteSurveysSql</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
            <code>deleteSurveysSql()</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description"><p>Funcion para realizar sentencia DELETE en SQLite de una tabla</p>
            </div>
                                        <div class="io-description">
                                                <b>Parameters :</b>
                                                <ul class="jsdoc-params">
                                                        <li>
                                                            <div>
                                                                <b>table</b>
                                                            </div>
                                                            <div>
                                                                <p>Nombre de la tabla a seleccionar</p>
            
                                                            </div>
                                                        </li>
                                                </ul>
                                        </div>
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                            <div class="io-description">
                                                
                                            </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> saveSurveyToSql</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
            <code>saveSurveyToSql(surveyAnswered: any)</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description"><p>Funcion que toma las respuestas de una encuesta, agruega un campo unica para cada respuesta<br>luego se ejecuta una sentencia SQL INSERT, para guardar la respuesta de forma local en SQLite</p>
            </div>
                                        <div class="io-description">
                                                <b>Parameters :</b>
                                                <ul class="jsdoc-params">
                                                        <li>
                                                            <div>
                                                                <b>surveyAnswered</b>
                                                            </div>
                                                            <div>
                                                                <p>Objecto con la encuesta respondida y tipada para guardar</p>
            
                                                            </div>
                                                        </li>
                                                </ul>
                                        </div>
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                            <div class="io-description">
                                                <p>retorna respuesta de Sentencia SQL</p>
            
                                            </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b><span class="modifier"></span> getAllAnsweredSurveys</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <span class="modifier-icon method fa fa-play ">
                                            <span class="fa fa-"></span>
                                        </span>
                                    <code>getAllAnsweredSurveys()</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description"><p>Funcion que hace llamado a una seentencia SQL para obtener todas las encuestas respondidas</p>
            </div>
                                        <div class="io-description">
                                        </div>
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                            <div class="io-description">
                                                <p>retorna lista de encuestas respondidas</p>
            
                                            </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b><span class="modifier"></span> saveSurveyToLocalDB</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <span class="modifier-icon method fa fa-play ">
                                            <span class="fa fa-"></span>
                                        </span>
                                    <code>saveSurveyToLocalDB(surveyAnswered: any, _surveyName: any, _surveyId: any, _date: any)</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description"><p>Funcion para mapear y posteriormente guardar una encuesta en SQLite, que se respondio previamente.</p>
            </div>
                                        <div class="io-description">
                                                <b>Parameters :</b>
                                                <ul class="jsdoc-params">
                                                        <li>
                                                            <div>
                                                                <b>surveyAnswered</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                        <li>
                                                            <div>
                                                                <b>_surveyName</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                        <li>
                                                            <div>
                                                                <b>_surveyId</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                        <li>
                                                            <div>
                                                                <b>_date</b>
                                                                    :     <code>Date</code>
            
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                </ul>
                                        </div>
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                            <div class="io-description">
                                                
                                            </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
            </section>

            <section>
                <h3 id="inputs">Properties</h3>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b><span class="modifier">Private</span> _sqlInstance</b>
                                </td>
                            </tr>
                            <tr>
                                <td class="col-md-4">
                                    <span class="modifier-icon fa fa-lock"></span><code>_sqlInstance:     <code>SQLiteObject</code>
            </bcode>
                                </td>
                            </tr>
                            <tr>
                                <td class="col-md-4">
                                    <div class="io-description"><p>Objeto de instancia para SQLite</p>
            </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b><span class="modifier">Private</span> answeredSurvey</b>
                                </td>
                            </tr>
                            <tr>
                                <td class="col-md-4">
                                    <span class="modifier-icon fa fa-lock"></span><code>answeredSurvey:     <code>AnswerSurvey</code>
            </bcode>
                                </td>
                            </tr>
                            <tr>
                                <td class="col-md-4">
                                    <div class="io-description"><p>Objeto para guardar temporalmente las respuestas de las encuestas</p>
            </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b><span class="modifier">Public</span> sqlInstance</b>
                                </td>
                            </tr>
                            <tr>
                                <td class="col-md-4">
                                    <span class="modifier-icon fa fa-circle"></span><code>sqlInstance:     <code>SQLiteObject</code>
            </bcode>
                                </td>
                            </tr>
                            <tr>
                                <td class="col-md-4">
                                    <div class="io-description"><p>Funcion SETTER para asignar instancia de SQLlite<br>Funcion GETTER obtener instancia de SQLite</p>
            </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
            </section>
    </div>
    <div class="tab-pane fade tab-source-code" id="source">
        <pre><code class="hljs javascript">import { Injectable } from &#x27;@angular/core&#x27;;
  import { HttpClient } from &#x27;@angular/common/http&#x27;;
import { AnswerSurvey } from &#x27;../interfaces/answer-survey&#x27;;
import { SurveyService } from &#x27;./survey.service&#x27;;
import { Router } from &#x27;@angular/router&#x27;;
import { SubjectsService } from &#x27;./subjects.service&#x27;;
import { LoadingController } from &#x27;@ionic/angular&#x27;;
import { SQLite, SQLiteObject } from &#x27;@awesome-cordova-plugins/sqlite/ngx&#x27;;
import { mainForm } from &#x27;../interfaces/mainForm&#x27;;

/**
 * Servicio que manipula SQLite y hace llamados a la API
 */

@Injectable({
  providedIn: &#x27;root&#x27;
})
export class DbService {

  /**
   * Objeto de instancia para SQLite
   */
  private _sqlInstance: SQLiteObject;

  /**
   * Objeto para guardar temporalmente las respuestas de las encuestas
   */
  private answeredSurvey &#x3D; {} as AnswerSurvey;

    /**
     * @ignore
     */
    constructor(
      private httpClient: HttpClient, 
      private router: Router,
      private subjectService: SubjectsService,
      private loadingController: LoadingController,
      private sqlite: SQLite,
      private surveyservice: SurveyService
       ) { }
    
  

    /**
     * Funcion que hace llamada a la API para guardar las 
     * respuestas en la nube, luego limpia la BD SQLlite
     * @param {Array&lt;AnswerSurvey&gt;} surveys Lista de respuestas de encuesta
     */   
    syncSurvey(surveys: AnswerSurvey[]){
      this.presentLoading();

      // https://cabilapp.herokuapp.com

      this.httpClient.post&lt;any&gt;(&#x27;https://cabilapp.herokuapp.com/sync&#x27;,surveys).subscribe(data &#x3D;&gt; {
        this.cleanLocalDb();

      }, err &#x3D;&gt; {
        this.loadingController.dismiss();
         this.surveyservice.presentToast(&#x27;Error Sync&#x27;)

      });
    }


    /**
     * Funcion para limpiar base de datos SQLlite, luego redirecciona al HOME
     */
    cleanLocalDb(){
     
      localStorage.clear();
      this.deleteSurveysSql();
      this.surveyservice.presentToast(&#x27;Resuestas sincronizadas.&#x27;);
      this.router.navigateByUrl(&#x27;home&#x27;);
      this.subjectService.setSubject(&#x27;homeSurveysCount&#x27;,true);
      setTimeout(() &#x3D;&gt; {
        this.loadingController.dismiss();
      }, 1000);

    }

   /**
 * Funcion que presenta una anuimacion de cargando durante 1 segundo
  */
    async presentLoading() {
      const loading &#x3D; await this.loadingController.create({
        message: &#x27;Sincronizando&#x27;,
        spinner: &#x27;bubbles&#x27;
      });
      await loading.present();
    }


    /**
     * Funcion para cerrar animacion de cargando
     */
    dismissLoading(){
      this.loadingController.dismiss();
    }

    /**
     * Funcion SETTER para asignar instancia de SQLlite
     */
    public set sqlInstance(v : SQLiteObject) {
      this._sqlInstance &#x3D; v;
    }
  
    
    /**
     * Funcion GETTER obtener instancia de SQLite
     */
    public get sqlInstance() : SQLiteObject {
      return this._sqlInstance
    }


    /**
     * Funcion que crea las tablas de SQLite localmente: mainForm y surveys
     */
    initSql(){     

    this.sqlite.create({
      name: &#x27;data.db&#x27;,
      location: &#x27;default&#x27;
    })
      .then((db: SQLiteObject) &#x3D;&gt; {

        console.log(&#x27;sqlite Instance:&#x27;, db );
        
        this.sqlInstance &#x3D; db;
        
        //  this.deleteSql();

        db.executeSql(
          &#x60;CREATE TABLE  mainForm (
            NumeroIdentificacion  INTEGER,
            sexo  INTEGER,
            IntervaloEdad  INTEGER,
            Genero  INTEGER,
            GrupEtnico  INTEGER,
            id_MarquesasApp_Municipio_id  INTEGER,
            Zona TEXT,
            condicion_discapacidad TEXT ,
            conflicto_armado  TEXT,
            img  TEXT
            )&#x60;, [])
          .then(() &#x3D;&gt; {console.log(&#x27;Executed MAINFORM SQL&#x27;); })
          .catch(e &#x3D;&gt; console.log(&#x27;Error&#x27;, e));

          db.executeSql(
            
            &#x60;CREATE TABLE  surveys (
              NumeroIdentificacion INTEGER, 
              IntervaloEdad INTEGER,
              Genero INTEGER,
              GrupEtnico INTEGER,
              Zona INTEGER,
              Respuesta1 INTEGER,
              Respuesta2 INTEGER,
              Respuesta3 INTEGER,
              Respuesta4 INTEGER,
              Respuesta5 INTEGER,
              Respuesta6 INTEGER,
              Respuesta7 INTEGER,
              Respuesta8 INTEGER,
              Respuesta9 INTEGER,
              Respuesta10 INTEGER,
              Respuesta11 INTEGER,
              Respuesta12 INTEGER,
              date_created TEXT,
              usuario TEXT,
              id_MarquesasApp_Municipio_id INTEGER,
              id_WebTablasBasicasApp_encuesta_id INTEGER,
              sexo INTEGER, 
              condicion_discapacidad TEXT,
              conflicto_armado TEXT,
              surveyName TEXT,
              img TEXT,
              idRespuesta TEXT
              )&#x60;, [])
            .then(() &#x3D;&gt; {console.log(&#x27;Executed SURVEY SQL&#x27;); })
            .catch(e &#x3D;&gt; console.log(&#x27;Error&#x27;, e));
    
    
      })
      .catch(e &#x3D;&gt; console.log(e));
    }

    /**
     * Funcion para realizar sentencia SELECT en SQLite de una tabla
     * @param {string} table  Nombre de la tabla a seleccionar
     * @returns retorna la respuesta de la sentencia SQL
     */
    async selectSql(table: string):Promise&lt;any&gt;{

      var testsql :SQLiteObject &#x3D; this.sqlInstance;
     return  testsql.executeSql(&#x60;SELECT * FROM ${table} &#x60;,[])
     
    }


    /**
     * Funcion para realizar sentencia DELETE en SQLite de una tabla
     *@param {string} table  Nombre de la tabla a seleccionar
     */
    deleteSql(table?:string){

      var testsql :SQLiteObject &#x3D; this.sqlInstance;
      testsql.executeSql(&#x27;DELETE FROM mainForm &#x27;,[])
      .then(res &#x3D;&gt; {

        console.log(&#x27;Table deleted&#x27;)
      }).catch(err &#x3D;&gt; {

        console.error(err)
      })
    }

      /**
     * Funcion para realizar sentencia DELETE en SQLite de una tabla
     *@param {string} table  Nombre de la tabla a seleccionar
     */
    deleteSurveysSql(){
      var testsql :SQLiteObject &#x3D; this.sqlInstance;
      testsql.executeSql(&#x27;DELETE FROM surveys &#x27;,[])
      .then(res &#x3D;&gt; {

        console.log(&#x27;Table surveys deleted&#x27;)
      }).catch(err &#x3D;&gt; {

        console.error(err)
      })
    }

    /**
     * Funcion que toma las respuestas de una encuesta, agruega un campo unica para cada respuesta
     * luego se ejecuta una sentencia SQL INSERT, para guardar la respuesta de forma local en SQLite
     * @param surveyAnswered Objecto con la encuesta respondida y tipada para guardar
     * @returns retorna respuesta de Sentencia SQL
     */
    saveSurveyToSql(surveyAnswered: any){


      var subS &#x3D; (surveyAnswered.NumeroIdentificacion + &quot; &quot;).substring(0,3)

      // var idRespuesta &#x3D; &#x60;${subS}${surveyAnswered.id_MarquesasApp_Municipio_id}${surveyAnswered.img.substring(2500,2503)}&#x60;

      var timeString  &#x3D; String(Math.floor(new Date().getTime()/1000.0)).slice(-4);

      var idRespuesta &#x3D; &#x60;${subS}${surveyAnswered.id_MarquesasApp_Municipio_id}${Number(timeString)}&#x60;

      var sql: SQLiteObject &#x3D; this.sqlInstance;

 

      return sql.executeSql(&#x60;
      INSERT INTO surveys 
      VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)&#x60;,
      [
        surveyAnswered.NumeroIdentificacion, 
        surveyAnswered.IntervaloEdad,
        surveyAnswered.Genero,
        surveyAnswered.GrupEtnico,
        surveyAnswered.Zona,
        surveyAnswered.Respuesta1,
        surveyAnswered.Respuesta2,
        surveyAnswered.Respuesta3,
        surveyAnswered.Respuesta4,
        surveyAnswered.Respuesta5,
        surveyAnswered.Respuesta6,
        surveyAnswered.Respuesta7,
        surveyAnswered.Respuesta8,
        surveyAnswered.Respuesta9,
        surveyAnswered.Respuesta10,
        surveyAnswered.Respuesta11,
        surveyAnswered.Respuesta12,
        surveyAnswered.date_created,
        surveyAnswered.usuario,
        surveyAnswered.id_MarquesasApp_Municipio_id,
        surveyAnswered.id_WebTablasBasicasApp_encuesta_id,
        surveyAnswered.sexo, 
        surveyAnswered.condicion_discapacidad,
        surveyAnswered.conflicto_armado,
        surveyAnswered.surveyName,
        surveyAnswered.img,
        idRespuesta
      ]); 

    }


    /**
     * Funcion que hace llamado a una seentencia SQL para obtener todas las encuestas respondidas
     * @returns retorna lista de encuestas respondidas
     */
   async getAllAnsweredSurveys(){

    let surveys &#x3D; await this.selectSql(&#x27;surveys&#x27;);   

      return  surveys.rows;
    };

    /**
     * Funcion para mapear y posteriormente guardar una encuesta en SQLite, que se respondio previamente.
     * @param surveyAnswered 
     * @param {string} _surveyName 
     * @param {any} _surveyId 
     * @param {Date} _date 
     * @returns 
     */
   async saveSurveyToLocalDB(surveyAnswered , _surveyName, _surveyId, _date){     
     
  
       let mainForm &#x3D; await this.selectSql(&#x27;mainForm&#x27;);

  
      this.answeredSurvey &#x3D; {
        ...mainForm.rows.item(0),
        Respuesta1: surveyAnswered[0],
        Respuesta2: surveyAnswered[1],
        Respuesta3: surveyAnswered[2],
        Respuesta4: surveyAnswered[3],
        Respuesta5: surveyAnswered[4],
        Respuesta6: surveyAnswered[5],
        Respuesta7: surveyAnswered[6],
        Respuesta8: surveyAnswered[7],
        Respuesta9: surveyAnswered[8],
        Respuesta10: surveyAnswered[9],
        Respuesta11: surveyAnswered[10],
        Respuesta12: surveyAnswered[11],
        date_created: _date,
        usuario: &#x27;marquesa&#x27;,
        id_WebTablasBasicasApp_encuesta_id: _surveyId,
        surveyName: _surveyName
      }
      
       let saveSurveyStatus &#x3D; await this.saveSurveyToSql(this.answeredSurvey);   
       this.deleteSql();
       
       return saveSurveyStatus;
      
    }
}

</code></pre>
    </div>
</div>







                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
           </div>
       </div>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/search/search.js"></script>
       <script src="../js/search/lunr.min.js"></script>
       <script src="../js/search/search-lunr.js"></script>

       <script src="../js/menu.js"></script>
       <script src="../js/libs/highlight.pack.js"></script>
       <script src="../js/libs/highlightjs-line-numbers.min.js"></script>
       <script src="../js/search/search_index.js"></script>
       <script>
            document.addEventListener('DOMContentLoaded', function() {
                hljs.initHighlightingOnLoad();
                hljs.initLineNumbersOnLoad();
            });
       </script>

    </body>
</html>
